#pragma once

#include "Shared.hpp"

enum struct Texture_Field {
	NONE,
	SST, // Sea Surface Temperature
	LST, // Land Surface Temperature
	CLOUD_CONTENT,
	CLOUD_FRACT,
	CLOUD_RAD
};

vec1 lut(const Texture_Field& field, const vec4& color) {
	vector<uvec3> table;
	switch (field) {
		case Texture_Field::SST : {
			table = {
				uvec3(91, 3, 24),
				uvec3(91, 4, 25),
				uvec3(92, 5, 25),
				uvec3(93, 6, 26),
				uvec3(94, 7, 27),
				uvec3(95, 8, 27),
				uvec3(95, 9, 28),
				uvec3(96, 10, 29),
				uvec3(97, 11, 29),
				uvec3(98, 12, 30),
				uvec3(99, 13, 30),
				uvec3(100, 14, 31),
				uvec3(100, 15, 32),
				uvec3(101, 16, 32),
				uvec3(102, 17, 33),
				uvec3(103, 18, 34),
				uvec3(104, 19, 34),
				uvec3(104, 20, 35),
				uvec3(105, 21, 36),
				uvec3(106, 22, 36),
				uvec3(107, 23, 37),
				uvec3(108, 24, 38),
				uvec3(108, 25, 38),
				uvec3(109, 26, 39),
				uvec3(110, 27, 40),
				uvec3(111, 28, 40),
				uvec3(112, 29, 41),
				uvec3(112, 30, 42),
				uvec3(113, 31, 42),
				uvec3(114, 32, 43),
				uvec3(115, 33, 43),
				uvec3(116, 34, 44),
				uvec3(117, 35, 45),
				uvec3(117, 36, 45),
				uvec3(118, 37, 46),
				uvec3(119, 38, 47),
				uvec3(120, 39, 47),
				uvec3(121, 40, 48),
				uvec3(121, 41, 49),
				uvec3(122, 42, 49),
				uvec3(123, 43, 50),
				uvec3(124, 44, 51),
				uvec3(125, 45, 51),
				uvec3(125, 46, 52),
				uvec3(126, 47, 53),
				uvec3(127, 48, 53),
				uvec3(128, 49, 54),
				uvec3(129, 50, 55),
				uvec3(129, 51, 55),
				uvec3(130, 52, 56),
				uvec3(131, 53, 56),
				uvec3(132, 54, 57),
				uvec3(133, 55, 58),
				uvec3(134, 56, 58),
				uvec3(134, 57, 59),
				uvec3(135, 58, 60),
				uvec3(136, 59, 60),
				uvec3(137, 60, 61),
				uvec3(138, 61, 62),
				uvec3(138, 62, 62),
				uvec3(139, 63, 63),
				uvec3(140, 64, 64),
				uvec3(140, 66, 64),
				uvec3(140, 67, 65),
				uvec3(141, 69, 65),
				uvec3(141, 70, 66),
				uvec3(141, 71, 66),
				uvec3(141, 73, 67),
				uvec3(141, 74, 68),
				uvec3(142, 76, 68),
				uvec3(142, 77, 69),
				uvec3(142, 78, 69),
				uvec3(142, 80, 70),
				uvec3(142, 81, 70),
				uvec3(143, 83, 71),
				uvec3(143, 84, 71),
				uvec3(143, 86, 72),
				uvec3(143, 87, 73),
				uvec3(143, 88, 73),
				uvec3(144, 90, 74),
				uvec3(144, 91, 74),
				uvec3(144, 93, 75),
				uvec3(144, 94, 75),
				uvec3(144, 95, 76),
				uvec3(145, 97, 77),
				uvec3(145, 98, 77),
				uvec3(145, 100, 78),
				uvec3(145, 101, 78),
				uvec3(145, 102, 79),
				uvec3(146, 104, 79),
				uvec3(146, 105, 80),
				uvec3(146, 107, 80),
				uvec3(146, 108, 81),
				uvec3(147, 109, 82),
				uvec3(147, 111, 82),
				uvec3(147, 112, 83),
				uvec3(147, 114, 83),
				uvec3(147, 115, 84),
				uvec3(148, 116, 84),
				uvec3(148, 118, 85),
				uvec3(148, 119, 86),
				uvec3(148, 121, 86),
				uvec3(148, 122, 87),
				uvec3(149, 123, 87),
				uvec3(149, 125, 88),
				uvec3(149, 126, 88),
				uvec3(149, 128, 89),
				uvec3(149, 129, 89),
				uvec3(150, 131, 90),
				uvec3(150, 132, 91),
				uvec3(150, 133, 91),
				uvec3(150, 135, 92),
				uvec3(150, 136, 92),
				uvec3(151, 138, 93),
				uvec3(151, 139, 93),
				uvec3(151, 140, 94),
				uvec3(151, 142, 95),
				uvec3(151, 143, 95),
				uvec3(152, 145, 96),
				uvec3(152, 146, 96),
				uvec3(152, 147, 97),
				uvec3(152, 149, 97),
				uvec3(152, 150, 98),
				uvec3(153, 152, 98),
				uvec3(153, 153, 99),
				uvec3(153, 154, 100),
				uvec3(153, 155, 100),
				uvec3(152, 155, 101),
				uvec3(152, 156, 101),
				uvec3(152, 157, 102),
				uvec3(151, 158, 102),
				uvec3(151, 159, 103),
				uvec3(151, 159, 103),
				uvec3(151, 160, 104),
				uvec3(150, 161, 104),
				uvec3(150, 162, 105),
				uvec3(150, 163, 105),
				uvec3(149, 163, 106),
				uvec3(149, 164, 106),
				uvec3(149, 165, 107),
				uvec3(148, 166, 108),
				uvec3(148, 167, 108),
				uvec3(148, 167, 109),
				uvec3(147, 168, 109),
				uvec3(147, 169, 110),
				uvec3(147, 170, 110),
				uvec3(146, 171, 111),
				uvec3(146, 171, 111),
				uvec3(146, 172, 112),
				uvec3(146, 173, 112),
				uvec3(145, 174, 113),
				uvec3(145, 175, 113),
				uvec3(145, 175, 114),
				uvec3(144, 176, 114),
				uvec3(144, 177, 115),
				uvec3(144, 178, 115),
				uvec3(143, 179, 116),
				uvec3(143, 179, 117),
				uvec3(143, 180, 117),
				uvec3(142, 181, 118),
				uvec3(142, 182, 118),
				uvec3(142, 182, 119),
				uvec3(141, 183, 119),
				uvec3(141, 184, 120),
				uvec3(141, 185, 120),
				uvec3(141, 186, 121),
				uvec3(140, 186, 121),
				uvec3(140, 187, 122),
				uvec3(140, 188, 122),
				uvec3(139, 189, 123),
				uvec3(139, 190, 123),
				uvec3(139, 190, 124),
				uvec3(138, 191, 125),
				uvec3(138, 192, 125),
				uvec3(138, 193, 126),
				uvec3(137, 194, 126),
				uvec3(137, 194, 127),
				uvec3(137, 195, 127),
				uvec3(136, 196, 128),
				uvec3(136, 197, 128),
				uvec3(136, 198, 129),
				uvec3(136, 198, 129),
				uvec3(135, 199, 130),
				uvec3(135, 200, 130),
				uvec3(135, 201, 131),
				uvec3(134, 202, 131),
				uvec3(134, 202, 132),
				uvec3(134, 203, 132),
				uvec3(133, 204, 133),
				uvec3(133, 205, 135),
				uvec3(134, 206, 136),
				uvec3(135, 206, 138),
				uvec3(136, 207, 140),
				uvec3(137, 208, 142),
				uvec3(139, 209, 143),
				uvec3(140, 210, 145),
				uvec3(141, 210, 147),
				uvec3(142, 211, 148),
				uvec3(143, 212, 150),
				uvec3(144, 213, 152),
				uvec3(145, 214, 153),
				uvec3(146, 214, 155),
				uvec3(147, 215, 157),
				uvec3(149, 216, 159),
				uvec3(150, 217, 160),
				uvec3(151, 218, 162),
				uvec3(152, 218, 164),
				uvec3(153, 219, 165),
				uvec3(154, 220, 167),
				uvec3(155, 221, 169),
				uvec3(156, 222, 170),
				uvec3(157, 222, 172),
				uvec3(159, 223, 174),
				uvec3(160, 224, 176),
				uvec3(161, 225, 177),
				uvec3(162, 226, 179),
				uvec3(163, 226, 181),
				uvec3(164, 227, 182),
				uvec3(165, 228, 184),
				uvec3(166, 229, 186),
				uvec3(167, 230, 188),
				uvec3(169, 230, 189),
				uvec3(170, 231, 191),
				uvec3(171, 232, 193),
				uvec3(172, 233, 194),
				uvec3(173, 233, 196),
				uvec3(174, 234, 198),
				uvec3(175, 235, 199),
				uvec3(176, 236, 201),
				uvec3(177, 237, 203),
				uvec3(178, 237, 205),
				uvec3(180, 238, 206),
				uvec3(181, 239, 208),
				uvec3(182, 240, 210),
				uvec3(183, 241, 211),
				uvec3(184, 241, 213),
				uvec3(185, 242, 215),
				uvec3(186, 243, 216),
				uvec3(187, 244, 218),
				uvec3(188, 245, 220),
				uvec3(190, 245, 222),
				uvec3(191, 246, 223),
				uvec3(192, 247, 225),
				uvec3(193, 248, 227),
				uvec3(194, 249, 228),
				uvec3(195, 249, 230),
				uvec3(196, 250, 232),
				uvec3(197, 251, 233),
				uvec3(198, 252, 235),
				uvec3(200, 253, 237),
				uvec3(201, 253, 239),
				uvec3(202, 255, 242),
				uvec3(204, 0, 0)
			};
			break;
		}
		case Texture_Field::LST: {
			table = {
				uvec3(241, 154, 230),
				uvec3(238, 139, 223),
				uvec3(235, 121, 216),
				uvec3(231, 103, 209),
				uvec3(229, 85, 200),
				uvec3(226, 67, 192),
				uvec3(222, 50, 185),
				uvec3(219, 34, 177),
				uvec3(216, 20, 170),
				uvec3(213, 10, 164),
				uvec3(212, 2, 159),
				uvec3(210, 2, 156),
				uvec3(210, 2, 153),
				uvec3(210, 2, 151),
				uvec3(210, 2, 149),
				uvec3(210, 2, 147),
				uvec3(210, 2, 144),
				uvec3(210, 2, 142),
				uvec3(210, 2, 140),
				uvec3(210, 2, 138),
				uvec3(210, 2, 137),
				uvec3(210, 2, 134),
				uvec3(210, 2, 132),
				uvec3(210, 2, 131),
				uvec3(210, 2, 129),
				uvec3(210, 2, 128),
				uvec3(210, 2, 125),
				uvec3(210, 2, 123),
				uvec3(210, 2, 122),
				uvec3(210, 2, 120),
				uvec3(210, 2, 118),
				uvec3(210, 2, 116),
				uvec3(210, 2, 114),
				uvec3(210, 2, 113),
				uvec3(210, 2, 111),
				uvec3(210, 2, 108),
				uvec3(210, 2, 106),
				uvec3(210, 2, 104),
				uvec3(209, 2, 102),
				uvec3(208, 2, 101),
				uvec3(208, 2, 99),
				uvec3(207, 3, 97),
				uvec3(205, 2, 95),
				uvec3(204, 2, 93),
				uvec3(202, 2, 92),
				uvec3(201, 2, 89),
				uvec3(200, 2, 87),
				uvec3(197, 2, 85),
				uvec3(196, 2, 83),
				uvec3(194, 2, 81),
				uvec3(192, 2, 80),
				uvec3(190, 2, 77),
				uvec3(189, 2, 76),
				uvec3(187, 2, 73),
				uvec3(185, 2, 72),
				uvec3(183, 2, 69),
				uvec3(181, 2, 67),
				uvec3(179, 2, 65),
				uvec3(178, 2, 63),
				uvec3(175, 2, 61),
				uvec3(174, 2, 59),
				uvec3(172, 2, 57),
				uvec3(169, 2, 55),
				uvec3(168, 2, 53),
				uvec3(167, 3, 52),
				uvec3(165, 4, 50),
				uvec3(163, 6, 49),
				uvec3(161, 6, 46),
				uvec3(160, 8, 45),
				uvec3(159, 10, 44),
				uvec3(158, 12, 41),
				uvec3(156, 14, 40),
				uvec3(155, 16, 39),
				uvec3(154, 18, 38),
				uvec3(153, 21, 36),
				uvec3(153, 23, 35),
				uvec3(152, 26, 34),
				uvec3(151, 29, 33),
				uvec3(152, 32, 32),
				uvec3(151, 35, 31),
				uvec3(151, 39, 29),
				uvec3(151, 43, 29),
				uvec3(151, 47, 28),
				uvec3(151, 50, 27),
				uvec3(151, 54, 25),
				uvec3(151, 59, 25),
				uvec3(152, 62, 24),
				uvec3(152, 67, 22),
				uvec3(152, 71, 22),
				uvec3(152, 75, 21),
				uvec3(152, 80, 20),
				uvec3(153, 84, 20),
				uvec3(153, 89, 19),
				uvec3(154, 94, 18),
				uvec3(153, 98, 17),
				uvec3(154, 102, 16),
				uvec3(154, 107, 16),
				uvec3(154, 111, 15),
				uvec3(154, 115, 14),
				uvec3(154, 120, 14),
				uvec3(154, 124, 13),
				uvec3(154, 129, 12),
				uvec3(154, 133, 11),
				uvec3(153, 137, 11),
				uvec3(153, 141, 9),
				uvec3(152, 145, 10),
				uvec3(152, 148, 9),
				uvec3(151, 152, 8),
				uvec3(151, 156, 8),
				uvec3(149, 159, 7),
				uvec3(149, 162, 7),
				uvec3(147, 166, 6),
				uvec3(145, 168, 6),
				uvec3(144, 171, 5),
				uvec3(142, 173, 4),
				uvec3(140, 176, 4),
				uvec3(139, 177, 3),
				uvec3(137, 179, 3),
				uvec3(134, 182, 2),
				uvec3(131, 183, 1),
				uvec3(129, 185, 1),
				uvec3(127, 187, 0),
				uvec3(123, 189, 0),
				uvec3(121, 190, 0),
				uvec3(117, 191, 0),
				uvec3(114, 193, 0),
				uvec3(111, 195, 0),
				uvec3(107, 196, 0),
				uvec3(104, 197, 0),
				uvec3(100, 199, 0),
				uvec3(97, 200, 0),
				uvec3(94, 201, 0),
				uvec3(89, 202, 0),
				uvec3(86, 203, 0),
				uvec3(82, 205, 0),
				uvec3(78, 205, 0),
				uvec3(74, 206, 0),
				uvec3(70, 208, 0),
				uvec3(66, 209, 0),
				uvec3(63, 210, 0),
				uvec3(59, 211, 0),
				uvec3(55, 211, 0),
				uvec3(52, 212, 0),
				uvec3(48, 213, 0),
				uvec3(44, 214, 0),
				uvec3(41, 215, 0),
				uvec3(38, 216, 0),
				uvec3(34, 217, 0),
				uvec3(31, 217, 0),
				uvec3(28, 218, 0),
				uvec3(24, 219, 0),
				uvec3(21, 220, 0),
				uvec3(18, 220, 0),
				uvec3(16, 221, 0),
				uvec3(12, 222, 0),
				uvec3(10, 223, 0),
				uvec3(8, 223, 0),
				uvec3(6, 224, 0),
				uvec3(4, 225, 0),
				uvec3(2, 226, 0),
				uvec3(0, 226, 1),
				uvec3(0, 227, 3),
				uvec3(0, 228, 5),
				uvec3(0, 228, 6),
				uvec3(0, 228, 8),
				uvec3(0, 229, 11),
				uvec3(0, 230, 13),
				uvec3(0, 230, 15),
				uvec3(0, 231, 17),
				uvec3(0, 231, 20),
				uvec3(0, 231, 22),
				uvec3(0, 232, 25),
				uvec3(0, 233, 28),
				uvec3(0, 232, 31),
				uvec3(0, 233, 33),
				uvec3(0, 233, 37),
				uvec3(0, 234, 40),
				uvec3(0, 235, 43),
				uvec3(0, 234, 46),
				uvec3(0, 235, 49),
				uvec3(0, 235, 52),
				uvec3(0, 235, 55),
				uvec3(0, 236, 59),
				uvec3(0, 237, 62),
				uvec3(0, 237, 66),
				uvec3(0, 237, 70),
				uvec3(0, 238, 73),
				uvec3(0, 238, 76),
				uvec3(0, 238, 80),
				uvec3(0, 239, 84),
				uvec3(0, 239, 88),
				uvec3(0, 239, 91),
				uvec3(0, 240, 95),
				uvec3(0, 239, 99),
				uvec3(0, 240, 102),
				uvec3(0, 240, 105),
				uvec3(0, 240, 110),
				uvec3(0, 241, 114),
				uvec3(0, 241, 117),
				uvec3(0, 241, 121),
				uvec3(0, 242, 125),
				uvec3(0, 242, 129),
				uvec3(0, 242, 132),
				uvec3(0, 243, 136),
				uvec3(0, 242, 139),
				uvec3(0, 243, 142),
				uvec3(0, 243, 146),
				uvec3(0, 243, 150),
				uvec3(0, 244, 153),
				uvec3(0, 244, 157),
				uvec3(0, 243, 160),
				uvec3(0, 244, 164),
				uvec3(0, 244, 167),
				uvec3(0, 244, 170),
				uvec3(0, 245, 173),
				uvec3(0, 245, 176),
				uvec3(0, 246, 180),
				uvec3(0, 245, 183),
				uvec3(0, 245, 185),
				uvec3(0, 246, 189),
				uvec3(0, 246, 191),
				uvec3(0, 246, 193),
				uvec3(0, 247, 196),
				uvec3(0, 247, 199),
				uvec3(0, 247, 202),
				uvec3(0, 247, 204),
				uvec3(0, 247, 206),
				uvec3(0, 247, 209),
				uvec3(0, 247, 211),
				uvec3(0, 247, 212),
				uvec3(0, 248, 214),
				uvec3(0, 247, 216),
				uvec3(0, 248, 220),
				uvec3(2, 249, 224),
				uvec3(5, 249, 227),
				uvec3(7, 249, 230),
				uvec3(11, 250, 230),
				uvec3(15, 250, 230),
				uvec3(19, 250, 230),
				uvec3(24, 250, 230),
				uvec3(29, 250, 230),
				uvec3(33, 250, 230),
				uvec3(38, 250, 230),
				uvec3(44, 250, 230),
				uvec3(48, 250, 230),
				uvec3(53, 250, 230),
				uvec3(59, 250, 230),
				uvec3(64, 250, 230),
				uvec3(68, 250, 230),
				uvec3(73, 250, 230),
				uvec3(77, 250, 230),
				uvec3(82, 250, 230),
				uvec3(86, 0, 0)
			};
			break;
		}
	}

	uvec3 inputColor = uvec3(color.r * 255.0f, color.g * 255.0f, color.b * 255.0f);
	vec1 minDistance = std::numeric_limits<float>::max();
	int closestIndex = -1;

	for (size_t i = 0; i < table.size(); ++i) {
		const uvec3& lutColor = table[i];

		float distance = length2(vec3(lutColor) - vec3(inputColor));

		if (distance < minDistance) {
			minDistance = distance;
			closestIndex = static_cast<int>(i);
		}
	}
	if (closestIndex == -1) {
		return 0.0f;
	}
	return closestIndex / ul_to_f(table.size() - 1);
}